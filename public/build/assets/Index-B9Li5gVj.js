import{r as d,W as I,j as e,Y as K,y as L}from"./app-BdDiG5MF.js";import{A as Q}from"./AuthenticatedLayout-CBw7v3pZ.js";import{P as V}from"./Pagination-D79vMfMK.js";import{T as D}from"./TextInput-BnM8wpwZ.js";import{I as r}from"./InputLabel-076v0EPL.js";import{I as l}from"./InputError-PGD3Jzm_.js";import{B as c}from"./button-DTwe3eK1.js";import{S as x}from"./SelectInput-B3moK6NF.js";import"./transition-Dkp8VegQ.js";import"./ThemeToggleButton-yQEJwIpi.js";function le({auth:a,site_settings:y,transfers:i,boxes:o,boxList:w,queryParams:k=null}){k=k||{};const[m,M]=d.useState(!1),[C,O]=d.useState(!1),[P,E]=d.useState(null),{data:u,setData:b,post:A,errors:h,reset:S}=I({from_box_id:"",to_box_id:"",amount:"",description:""}),{data:p,setData:n,post:R,errors:g,reset:B}=I({from_box_id:"",to_box_id:"",amount:"",description:"",_method:"PUT"}),j=()=>{M(!m),m||S()},[_,f]=d.useState(""),[z,F]=d.useState([]),v=(t=null)=>{t?(E(t),n({from_box_id:t.from_box_id,to_box_id:t.to_box_id,amount:t.amount,_method:"PUT"}),f(t.from_box_id)):(E(null),B(),f("")),O(!C)},U=t=>{const s=t.target.value;n("from_box_id",s),f(s)};d.useEffect(()=>{if(_){const t=w.filter(s=>s.id!==parseInt(_));F(t)}else F(o)},[_,o]);const $=t=>{t.preventDefault(),R(route("box-transfer.update",P.id),{onSuccess:()=>{B(),v()}})},[N,W]=d.useState(""),[Y,T]=d.useState([]),G=t=>{const s=t.target.value;b("from_box_id",s),W(s)};d.useEffect(()=>{if(N){const t=w.filter(s=>s.id!==parseInt(N));T(t)}else T(o)},[N,o]);const H=t=>{t.preventDefault(),A(route("box-transfer.store"),{onSuccess:()=>{S(),j()}})},J=t=>{window.confirm("هل انت متاكد من حذف الصندوق ؟ ")&&L.delete(route("box-transfer.destroy",t),{onSuccess:s=>{}})};return e.jsxs(Q,{user:a.user,site_settings:y,header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-base font-semibold leading-tight md:text-xl dark:text-gray-200",children:"تحويلات الصناديق"}),a.user.permissions.includes("create-box-transfer")&&e.jsx("button",{onClick:j,className:"px-3 py-1 text-white transition-all rounded shadow bg-burntOrange ",children:"تحويلات الصناديق"})]}),children:[e.jsx(K,{title:y.websiteName+" - تحويلات الصناديق"}),e.jsx("div",{className:"",children:e.jsx("div",{className:"mx-auto ",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm dark:bg-gray-800 ",children:e.jsx("div",{className:"p-3 text-gray-900 md:p-3 dark:text-gray-100",children:e.jsxs("div",{className:"mt-6 overflow-auto",children:[e.jsxs("table",{className:"w-full text-sm text-left text-gray-500 rtl:text-right dark:text-gray-400",children:[e.jsx("thead",{className:"text-gray-700 uppercase border-b-2 border-gray-500 bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-xs text-nowrap md:text-base",children:"من الصندوق"}),e.jsx("th",{className:"p-3 text-xs text-nowrap md:text-base",children:"إلى الصندوق"}),e.jsx("th",{className:"p-3 text-xs text-nowrap md:text-base",children:"القيمة"}),e.jsx("th",{className:"p-3 text-xs text-nowrap md:text-base",children:"اضافة بواسطة"}),e.jsx("th",{className:"p-3 text-xs text-nowrap md:text-base",children:"تحديث بواسطة"}),e.jsx("th",{className:"p-3 text-xs text-nowrap md:text-base",children:"الإجراءات"})]})}),e.jsx("tbody",{children:i&&i.data.length>0?i.data.map((t,s)=>e.jsxs("tr",{className:`${s%2===0?"bg-white":"bg-gray-100"} border-b dark:${s%2===0?"bg-gray-800":"bg-gray-700"} dark:border-gray-700`,children:[e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base",children:t.from_box.name}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base",children:t.to_box.name}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base",children:t.amount}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base",children:t.created_by.name}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base",children:t.updated_by?t.updated_by.name:""}),e.jsxs("td",{className:"px-3 py-2 text-nowrap",children:[a.user.permissions.includes("update-box-transfer")&&e.jsx("button",{onClick:()=>v(t),className:"mx-1 font-medium text-blue-600 dark:text-blue-500 hover:underline",children:"تعديل"}),a.user.permissions.includes("delete-box-transfer")&&e.jsx("button",{onClick:()=>J(t.id),className:"mx-1 font-medium text-red-600 dark:text-red-500 hover:underline",children:"حذف"})]})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center",children:"لا توجد تحويلات"})})})]}),e.jsx(V,{links:i.links})]})})})})}),m&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg md:w-10/12 dark:bg-gray-800",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h2",{className:"text-lg font-semibold",children:"إضافة تحويل"})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:H,children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5 md:grid-cols-3",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx(r,{className:"mb-3",htmlFor:"from_box_id",value:"من الصندوق"}),e.jsxs(x,{id:"from_box_id",name:"from_box_id",value:u.from_box_id||"",onChange:G,children:[e.jsx("option",{value:"",children:"اختر"}),a.user.roles.includes("Accountant")?e.jsx("option",{value:a.user.box_id,children:a.user.box_name}):o.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",t.balance]},t.id))]}),e.jsx(l,{message:h.from_box_id})]}),e.jsxs("div",{className:"col-span-1 ",children:[e.jsx(r,{className:"mb-3",htmlFor:"to_box_id",value:"إلى الصندوق"}),e.jsxs(x,{id:"to_box_id",name:"to_box_id",value:u.to_box_id||"",onChange:t=>b("to_box_id",t.target.value),children:[e.jsx("option",{value:"",children:"اختر"}),Y.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(l,{message:h.to_box_id})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx(r,{className:"mb-3",htmlFor:"amount",value:"القيمة"}),e.jsx(D,{id:"amount",type:"number",className:"block w-full mt-1",value:u.amount,onChange:t=>b("amount",t.target.value)}),e.jsx(l,{className:"mt-2",message:h.amount})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[e.jsx(c,{type:"button",onClick:j,className:"mr-2 bg-gray-500 hover:bg-gray-600",children:"إلغاء"}),e.jsx(c,{type:"submit",className:"bg-blue-500 hover:bg-blue-600",children:"إضافة"})]})]})})]})}),C&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg md:w-10/12 dark:bg-gray-800",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h2",{className:"text-lg font-semibold dark:text-white",children:"تعديل التحويل"})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:$,children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx(r,{className:"mb-3",htmlFor:"from_box_id",value:"من الصندوق"}),e.jsx(x,{id:"from_box_id",name:"from_box_id",value:p.from_box_id||"",onChange:U,children:a.user.roles.includes("Accountant")?e.jsx("option",{value:a.user.accountant.box_id,children:a.user.accountant.box_name}):o.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",t.balance]},t.id))}),e.jsx(l,{message:g.from_box_id})]}),e.jsxs("div",{className:"",children:[e.jsx(r,{className:"mb-3",htmlFor:"to_box_id",value:"إلى الصندوق"}),e.jsxs(x,{id:"to_box_id",name:"to_box_id",value:p.to_box_id||"",onChange:t=>n("to_box_id",t.target.value),children:[e.jsx("option",{value:"",children:"اختر"}),z.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(l,{message:g.to_box_id})]}),e.jsxs("div",{children:[e.jsx(r,{className:"mb-3",htmlFor:"amount",value:"القيمة"}),e.jsx(D,{id:"amount",type:"number",value:p.amount,className:"block w-full mt-1",onChange:t=>n("amount",t.target.value)}),e.jsx(l,{className:"mt-2",message:g.amount})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[e.jsx(c,{type:"button",onClick:v,className:"mr-2 bg-gray-500 hover:bg-gray-600",children:"إلغاء"}),e.jsx(c,{type:"submit",className:"bg-blue-500 hover:bg-blue-600",children:"حفظ التعديلات"})]})]})})]})})]})}export{le as default};
