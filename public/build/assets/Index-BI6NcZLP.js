import{r as l,j as e,W as I,Y as ee,y as U}from"./app-BdDiG5MF.js";import{P as ae}from"./Pagination-D79vMfMK.js";import{T as d}from"./TextInput-BnM8wpwZ.js";import{f as se,g as te,h as C,i as re,u as ne,j as le,k as oe,A as de,F as ce,M as ie}from"./AuthenticatedLayout-CBw7v3pZ.js";import{I as i}from"./InputLabel-076v0EPL.js";import{I as m}from"./InputError-PGD3Jzm_.js";import"./SelectInput-B3moK6NF.js";import{c as W,A as me,D as xe,C as pe,a as ue,R as he}from"./index-C2fsUSVT.js";import"./transition-Dkp8VegQ.js";import"./ThemeToggleButton-yQEJwIpi.js";var O,H="HoverCard",[z,He]=se(H,[W]),F=W(),[ge,A]=z(H),B=s=>{const{__scopeHoverCard:o,children:r,open:n,defaultOpen:c,onOpenChange:x,openDelay:b=700,closeDelay:N=300}=s,u=F(o),k=l.useRef(0),v=l.useRef(0),E=l.useRef(!1),j=l.useRef(!1),[S=!1,t]=le({prop:n,defaultProp:c,onChange:x}),P=l.useCallback(()=>{clearTimeout(v.current),k.current=window.setTimeout(()=>t(!0),b)},[b,t]),p=l.useCallback(()=>{clearTimeout(k.current),!E.current&&!j.current&&(v.current=window.setTimeout(()=>t(!1),N))},[N,t]),h=l.useCallback(()=>t(!1),[t]);return l.useEffect(()=>()=>{clearTimeout(k.current),clearTimeout(v.current)},[]),e.jsx(ge,{scope:o,open:S,onOpenChange:t,onOpen:P,onClose:p,onDismiss:h,hasSelectionRef:E,isPointerDownOnContentRef:j,children:e.jsx(he,{...u,children:r})})};B.displayName=H;var K="HoverCardTrigger",V=l.forwardRef((s,o)=>{const{__scopeHoverCard:r,...n}=s,c=A(K,r),x=F(r);return e.jsx(me,{asChild:!0,...x,children:e.jsx(te.a,{"data-state":c.open?"open":"closed",...n,ref:o,onPointerEnter:C(s.onPointerEnter,T(c.onOpen)),onPointerLeave:C(s.onPointerLeave,T(c.onClose)),onFocus:C(s.onFocus,c.onOpen),onBlur:C(s.onBlur,c.onClose),onTouchStart:C(s.onTouchStart,b=>b.preventDefault())})})});V.displayName=K;var ve="HoverCardPortal",[Ae,je]=z(ve,{forceMount:void 0}),R="HoverCardContent",G=l.forwardRef((s,o)=>{const r=je(R,s.__scopeHoverCard),{forceMount:n=r.forceMount,...c}=s,x=A(R,s.__scopeHoverCard);return e.jsx(re,{present:n||x.open,children:e.jsx(fe,{"data-state":x.open?"open":"closed",...c,onPointerEnter:C(s.onPointerEnter,T(x.onOpen)),onPointerLeave:C(s.onPointerLeave,T(x.onClose)),ref:o})})});G.displayName=R;var fe=l.forwardRef((s,o)=>{const{__scopeHoverCard:r,onEscapeKeyDown:n,onPointerDownOutside:c,onFocusOutside:x,onInteractOutside:b,...N}=s,u=A(R,r),k=F(r),v=l.useRef(null),E=ne(o,v),[j,S]=l.useState(!1);return l.useEffect(()=>{if(j){const t=document.body;return O=t.style.userSelect||t.style.webkitUserSelect,t.style.userSelect="none",t.style.webkitUserSelect="none",()=>{t.style.userSelect=O,t.style.webkitUserSelect=O}}},[j]),l.useEffect(()=>{if(v.current){const t=()=>{S(!1),u.isPointerDownOnContentRef.current=!1,setTimeout(()=>{var p;((p=document.getSelection())==null?void 0:p.toString())!==""&&(u.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",t),()=>{document.removeEventListener("pointerup",t),u.hasSelectionRef.current=!1,u.isPointerDownOnContentRef.current=!1}}},[u.isPointerDownOnContentRef,u.hasSelectionRef]),l.useEffect(()=>{v.current&&we(v.current).forEach(P=>P.setAttribute("tabindex","-1"))}),e.jsx(xe,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:b,onEscapeKeyDown:n,onPointerDownOutside:c,onFocusOutside:C(x,t=>{t.preventDefault()}),onDismiss:u.onDismiss,children:e.jsx(pe,{...k,...N,onPointerDown:C(N.onPointerDown,t=>{t.currentTarget.contains(t.target)&&S(!0),u.hasSelectionRef.current=!1,u.isPointerDownOnContentRef.current=!0}),ref:E,style:{...N.style,userSelect:j?"text":void 0,WebkitUserSelect:j?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),be="HoverCardArrow",Ne=l.forwardRef((s,o)=>{const{__scopeHoverCard:r,...n}=s,c=F(r);return e.jsx(ue,{...c,...n,ref:o})});Ne.displayName=be;function T(s){return o=>o.pointerType==="touch"?void 0:s()}function we(s){const o=[],r=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;r.nextNode();)o.push(r.currentNode);return o}var ye=B,_e=V,Y=G;const L=ye,$=_e,D=l.forwardRef(({className:s,align:o="center",sideOffset:r=4,...n},c)=>e.jsx(Y,{ref:c,align:o,sideOffset:r,className:oe("z-50 w-64 rounded-md border border-slate-200 bg-white p-4 text-slate-950 shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50",s),...n}));D.displayName=Y.displayName;function Me({auth:s,site_settings:o,users:r,queryParams:n=null,whatsapp_redirect:c}){n=n||{};const x=(a,g)=>{g?n[a]=g:delete n[a],delete n.page,U.get(route("customer.index"),n)},b=(a,g)=>{g.key==="Enter"&&x(a,g.target.value)};l.useEffect(()=>{c&&window.open(c,"_blank")},[c]);const[N,u]=l.useState(!1),[k,v]=l.useState(!1),[E,j]=l.useState(null),S=()=>{u(!N)},t=(a=null)=>{a?(j(a),f({name:a.name,user_name:a.user_name,email:a.email,phone:a.phone||"",whatsapp:a.whatsapp||"",customer_company:a.customer_company,added_credit_id:a.added_credit_id||null,added_credit:a.added_credit||0,used_credit_id:a.used_credit_id||null,used_credit:a.used_credit||0,_method:"PUT"})):(j(null),M()),v(!k)},P=a=>{window.confirm("هل انت متأكد من حذف المستخدم ؟ ")&&U.delete(route("customer.destroy",a.id),{onSuccess:g=>{g.props.success||g.props.danger}})},{data:p,setData:h,post:J,errors:w,reset:Q}=I({name:"",email:"",password:"",phone:"",whatsapp:""}),{data:y,setData:f,post:X,errors:_,reset:M}=I({name:"",email:"",password:"",phone:"",whatsapp:"",_method:"PUT"}),Z=a=>{a.preventDefault(),J(route("customer.store"),{onSuccess:()=>{Q(),S()}})},q=a=>{a.preventDefault(),X(route("customer.update",E.id),{onSuccess:()=>{M(),t()}})};return e.jsxs(de,{user:s.user,site_settings:o,header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight dark:text-gray-200",children:"العملاء"}),s.user.permissions.includes("create-customer")&&e.jsx("button",{onClick:S,className:"px-3 py-1 text-white transition-all rounded shadow bg-burntOrange ",children:"إضافة عميل"})]}),children:[e.jsx(ee,{title:o.websiteName+" - العملاء"}),e.jsx("div",{className:"",children:e.jsx("div",{className:"mx-auto ",children:e.jsx("div",{className:"overflow-hidden overflow-y-auto bg-white shadow-sm dark:bg-gray-800 ",children:e.jsxs("div",{className:"p-3 text-gray-900 md:p-3 dark:text-gray-100",children:[e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-gray-500 rtl:text-right dark:text-gray-400",children:[e.jsx("thead",{className:"text-gray-700 uppercase border-b-2 border-gray-500 bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{className:"text-nowrap",children:[e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base ",children:"Id"}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base min-w-36",children:"اسم الشركة"}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base min-w-36",children:"اسم الاتصال"}),e.jsx("td",{className:"text-xs text-nowrap md:text-base w-fit",children:"معلومات"}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base min-w-36",children:"الهاتف"}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base min-w-36",children:"التاريخ"}),e.jsx("th",{className:"p-3 text-xs text-nowrap md:text-base min-w-36",children:"الإجراءات"})]})}),e.jsx("thead",{className:"text-xs text-gray-700 uppercase border-b-2 border-gray-500 bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{className:"text-nowrap",children:[e.jsx("th",{className:"p-3"}),e.jsx("th",{className:"p-3",children:e.jsx(d,{className:"w-full",defaultValue:n.customer_company,placeholder:"اسم الشركة",onBlur:a=>x("customer_company",a.target.value),onKeyPress:a=>b("customer_company",a)})}),e.jsx("th",{className:"p-3",children:e.jsx(d,{className:"w-full",defaultValue:n.name,placeholder:"اسم الاتصال",onBlur:a=>x("name",a.target.value),onKeyPress:a=>b("name",a)})}),e.jsx("th",{className:""}),e.jsx("th",{className:""}),e.jsx("th",{className:"p-3"}),e.jsx("th",{className:"p-3"})]})}),e.jsx("tbody",{children:r&&r.data.length>0?r.data.map((a,g)=>e.jsxs("tr",{className:`${g%2===0?"bg-white":"bg-gray-100"} border-b dark:${g%2===0?"bg-gray-800":"bg-gray-700"} dark:border-gray-700`,children:[e.jsx("td",{className:"px-3 py-2",children:a.id}),e.jsx("td",{className:"px-3 py-2 text-nowrap",children:a.customer_company}),e.jsx("th",{className:"px-3 py-2 text-nowrap",children:a.name}),e.jsx("td",{className:"text-center text-nowrap base",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(L,{children:[e.jsx($,{children:e.jsx(ce,{className:"text-blue-700"})}),e.jsx(D,{children:a.user_name})]}),e.jsxs(L,{className:"",children:[e.jsx($,{children:e.jsx(ie,{className:"text-blue-700"})}),e.jsx(D,{children:a.email})]})]})}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("span",{className:"flex flex-col gap-2",children:[e.jsx("span",{children:a.phone?a.phone:"No Phone"}),e.jsx("span",{className:"text-xs",children:a.whatsapp?e.jsx("a",{href:`https://wa.me/${a.whatsapp}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:a.whatsapp}):"No WhatsApp"})]})}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"flex flex-col gap-2 text-xs",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{children:a.created_at}),e.jsx("span",{children:a.created_by})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{children:a.updated_at}),e.jsx("span",{children:a.updated_by})]})]})}),e.jsxs("td",{className:"px-3 py-2 text-nowrap",children:[s.user.permissions.includes("update-customer")&&a.id!=1&&e.jsx("button",{onClick:()=>t(a),className:"mx-1 font-medium text-blue-600 dark:text-blue-500 hover:underline",children:"تعديل"}),s.user.permissions.includes("delete-customer")&&a.id!=1&&e.jsx("button",{onClick:()=>P(a),className:"mx-1 font-medium text-red-600 dark:text-red-500 hover:underline",children:"حذف"})]})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-3 py-2 text-center",children:"لا يوجد عملاء"})})})]})}),r&&e.jsx(ae,{links:r.meta.links})]})})})}),N&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center overflow-auto bg-black bg-opacity-50 ",children:e.jsxs("div",{className:"duration-300 ease-in-out transform scale-95 bg-white rounded-lg shadow-lg overflow-autotransition-all sm:w-1/2 dark:bg-gray-800 animate-in",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-700 dark:text-white",children:"إضافة عميل جديد"})}),e.jsx("div",{className:"p-2 md:p-6",children:e.jsxs("form",{onSubmit:Z,children:[e.jsx("div",{className:"mb-4 text-lg text-gray-700 dark:text-white",children:"معلومات اضافية"}),e.jsxs("div",{className:"grid grid-cols-1 md:gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"name",value:"شخص الاتصال"}),e.jsx(d,{id:"name",type:"text",name:"name",value:p.name,isFocused:!0,className:"block w-full mt-1",onChange:a=>h("name",a.target.value)}),e.jsx(m,{message:w.name,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"name",value:"اسم الشركة"}),e.jsx(d,{id:"customer_company",type:"text",name:"customer_company",value:p.customer_company,className:"block w-full mt-1",onChange:a=>h("customer_company",a.target.value)}),e.jsx(m,{message:w.customer_company,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"phone",value:"الهاتف"}),e.jsx(d,{id:"phone",type:"text",name:"phone",placeholder:"+962799504930",dir:"ltr",value:p.phone,className:"block w-full mt-1",onChange:a=>h("phone",a.target.value)}),e.jsx(m,{message:w.phone,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"whatsapp",value:"whatsapp"}),e.jsx(d,{id:"whatsapp",type:"text",name:"whatsapp",placeholder:"+962799504930",dir:"ltr",value:p.whatsapp,className:"block w-full mt-1",onChange:a=>h("whatsapp",a.target.value)}),e.jsx(m,{message:w.whatsapp,className:"mt-2"})]})]}),e.jsx("div",{className:"mb-4 text-lg text-gray-700 dark:text-white",children:"معلومات الدخول"}),e.jsxs("div",{className:"grid grid-cols-1 md:gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"user_name",value:"اسم المستخدم"}),e.jsx(d,{id:"user_name",type:"text",name:"user_name",value:p.user_name,className:"block w-full mt-1",onChange:a=>h("user_name",a.target.value)}),e.jsx(m,{message:w.user_name,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"user_email",value:"البريد الإلكتروني"}),e.jsx(d,{id:"user_email",type:"email",name:"email",value:p.email,className:"block w-full mt-1",onChange:a=>h("email",a.target.value)}),e.jsx(m,{message:w.email,className:"mt-2"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"user_password",value:"كلمة المرور"}),e.jsx(d,{id:"user_password",type:"password",name:"password",value:p.password,className:"block w-full mt-1",onChange:a=>h("password",a.target.value)}),e.jsx(m,{message:w.password,className:"mt-2"})]}),e.jsx("div",{className:"mb-4 text-lg text-gray-700 dark:text-white",children:"قيمة الرصيد الافتتاحي"}),e.jsxs("div",{className:"grid grid-cols-1 md:gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"added_credit",value:"دائن بقيمة"}),e.jsx(d,{id:"added_credit",type:"number",name:"name",value:p.added_credit||0,className:"block w-full mt-1",onChange:a=>h("added_credit",a.target.value)}),e.jsx(m,{message:w.added_credit,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"used_credit",value:"مدين بقيمة"}),e.jsx(d,{id:"used_credit",type:"number",name:"name",value:p.used_credit||0,className:"block w-full mt-1",onChange:a=>h("used_credit",a.target.value)}),e.jsx(m,{message:w.used_credit,className:"mt-2"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:S,className:"px-4 py-2 text-white bg-gray-600 rounded hover:bg-gray-700",children:"إلغاء"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-white rounded bg-burntOrange ",children:"حفظ"})]})]})})]})}),k&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center overflow-auto bg-black bg-opacity-50",children:e.jsxs("div",{className:"transition-all duration-300 ease-in-out transform scale-95 bg-white rounded-lg shadow-lg sm:w-1/2 dark:bg-gray-800 animate-in",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-700 dark:text-white",children:"تعديل عميل"})}),e.jsx("div",{className:"p-2 md:p-6",children:e.jsxs("form",{onSubmit:q,children:[e.jsx("div",{className:"mb-4 text-lg text-gray-700 dark:text-white",children:"معلومات اضافية"}),e.jsxs("div",{className:"grid grid-cols-1 md:gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"edit_name",value:"شخص الاتصال"}),e.jsx(d,{id:"edit_name",type:"text",name:"name",value:y.name,className:"block w-full mt-1",onChange:a=>f("name",a.target.value)}),e.jsx(m,{message:_.name,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"edit_customer_company",value:"اسم الشركة "}),e.jsx(d,{id:"edit_customer_company",type:"text",name:"customer_company",value:y.customer_company,className:"block w-full mt-1",onChange:a=>f("customer_company",a.target.value)}),e.jsx(m,{message:_.customer_company,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"edit_phone",value:"الهاتف"}),e.jsx(d,{id:"edit_phone",type:"text",name:"phone",dir:"ltr",value:y.phone,className:"block w-full mt-1",placeholder:"+962799504930",onChange:a=>f("phone",a.target.value)}),e.jsx(m,{message:_.phone,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"edit_whatsapp",value:"whatsapp"}),e.jsx(d,{id:"edit_whatsapp",type:"text",name:"whatsapp",value:y.whatsapp,dir:"ltr",className:"block w-full mt-1",placeholder:"+962799504930",onChange:a=>f("whatsapp",a.target.value)}),e.jsx(m,{message:_.whatsapp,className:"mt-2"})]})]}),e.jsx("div",{className:"mb-4 text-lg text-gray-700 dark:text-white",children:"معلومات الدخول"}),e.jsxs("div",{className:"grid grid-cols-1 md:gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"edit_user_name",value:"اسم المستخدم"}),e.jsx(d,{id:"edit_user_name",type:"text",name:"user_name",value:y.user_name,className:"block w-full mt-1",onChange:a=>f("user_name",a.target.value)}),e.jsx(m,{message:_.user_name,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"edit_user_email",value:"البريد الإلكتروني"}),e.jsx(d,{id:"edit_user_email",type:"email",name:"email",value:y.email,className:"block w-full mt-1",onChange:a=>f("email",a.target.value)}),e.jsx(m,{message:_.email,className:"mt-2"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"edit_user_password",value:"كلمة المرور"}),e.jsx(d,{id:"edit_user_password",type:"password",name:"password",value:y.password,className:"block w-full mt-1",placeholder:"اكتب في حالة اردت تغيرها",onChange:a=>f("password",a.target.value)}),e.jsx(m,{message:_.password,className:"mt-2"})]}),e.jsx("div",{className:"mb-4 text-lg text-gray-700 dark:text-white",children:"قيمة الرصيد الافتتاحي"}),e.jsxs("div",{className:"grid grid-cols-1 md:gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"added_credit",value:"دائن بقيمة"}),e.jsx(d,{id:"added_credit",type:"number",name:"name",value:y.added_credit||"",className:"block w-full mt-1",onChange:a=>f("added_credit",a.target.value)}),e.jsx(m,{message:_.added_credit,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"used_credit",value:"مدين بقيمة"}),e.jsx(d,{id:"used_credit",type:"number",name:"name",value:y.used_credit||"",className:"block w-full mt-1",onChange:a=>f("used_credit",a.target.value)}),e.jsx(m,{message:_.used_credit,className:"mt-2"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>t(),className:"px-4 py-2 text-white bg-gray-600 rounded hover:bg-gray-700",children:"إلغاء"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-white rounded bg-burntOrange ",children:"حفظ التغييرات"})]})]})})]})})]})}export{Me as default};
