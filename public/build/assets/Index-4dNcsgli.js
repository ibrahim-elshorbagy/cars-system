import{r as m,W as E,j as e,Y as $,y as F}from"./app-BdDiG5MF.js";import{P as z}from"./Pagination-D79vMfMK.js";import{T as h}from"./TextInput-BnM8wpwZ.js";import{A}from"./AuthenticatedLayout-CBw7v3pZ.js";import{I as o}from"./InputLabel-076v0EPL.js";import{I as c}from"./InputError-PGD3Jzm_.js";import"./SelectInput-B3moK6NF.js";import{P as B,a as K,C as L,b as G,c as V,d as W,e as Y,f as H,g as J,h as Q,i as X}from"./popover-CZyhr6LC.js";import{B as Z}from"./button-DTwe3eK1.js";import"./transition-Dkp8VegQ.js";import"./ThemeToggleButton-yQEJwIpi.js";import"./index-C2fsUSVT.js";function me({auth:t,cities:d,ports:p,site_settings:i,queryParams:r=null}){r=r||{};const[x,u]=m.useState(!1),[n,g]=m.useState(!1),[a,j]=m.useState(null),N=()=>{u(!x)},f=(s=null)=>{s?(j(s),b({name:s.name,code:s.code,port_id:s.port_id,_method:"PUT"})):(j(null),S()),g(!n)},k=(s,l)=>{l?r[s]=l:delete r[s],delete r.page,F.get(route("city.index"),r)},D=(s,l)=>{l.key==="Enter"&&k(s,l.target.value)},O=s=>{window.confirm("هل انت متأكد من حذف المدينة ؟ ")&&F.delete(route("city.destroy",s.id),{onSuccess:l=>{}})},{data:_,setData:y,post:M,errors:v,reset:P}=E({name:""}),{data:w,setData:b,post:T,errors:C,reset:S}=E({name:"",_method:"PUT"}),R=s=>{s.preventDefault(),M(route("city.store"),{onSuccess:()=>{P(),N()}})},U=s=>{s.preventDefault(),T(route("city.update",a.id),{onSuccess:()=>{S(),f()}})};return e.jsxs(A,{site_settings:i,user:t.user,header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight dark:text-gray-200",children:"المدن (Cities)"}),t.user.permissions.includes("create-city")&&e.jsx("button",{onClick:N,className:"p-3 text-sm text-white transition-all rounded shadow md:text-base text-nowrap bg-burntOrange ",children:"إضافة مدينة"})]}),children:[e.jsx($,{title:i.websiteName+" - المدن (Cities)"}),e.jsx("div",{className:"",children:e.jsx("div",{className:"mx-auto ",children:e.jsx("div",{className:"overflow-hidden overflow-y-auto bg-white shadow-sm dark:bg-gray-800 ",children:e.jsxs("div",{className:"p-3 text-gray-900 md:p-3 dark:text-gray-100",children:[e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-gray-500 rtl:text-right dark:text-gray-400",children:[e.jsx("thead",{className:"text-gray-700 uppercase border-b-2 border-gray-500 bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{className:"text-nowrap",children:[e.jsx("td",{children:"Id"}),e.jsx("th",{className:"w-32 p-3",children:"كود "}),e.jsx("td",{className:"p-3 w-96",children:"المدينة"}),e.jsx("th",{className:"w-64 p-3",children:"الميناء"}),e.jsx("th",{className:"p-3 text-center",children:"االاجراءات"})]})}),e.jsx("thead",{className:"text-xs text-gray-700 uppercase border-b-2 border-gray-500 bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{className:"text-nowrap",children:[e.jsx("th",{className:"p-3"}),e.jsx("th",{className:"p-3"}),e.jsx("th",{className:"p-3",children:e.jsx(h,{className:"w-full",defaultValue:r.name,placeholder:"الاسم",isFocused:!0,onChange:s=>k("name",s.target.value),onKeyPress:s=>D("name",s)})}),e.jsx("th",{className:"p-3"}),e.jsx("th",{className:"p-3"})]})}),e.jsx("tbody",{children:d&&d.data.length>0?d.data.map((s,l)=>e.jsxs("tr",{className:`${l%2===0?"bg-white":"bg-gray-100"} border-b dark:${l%2===0?"bg-gray-800":"bg-gray-700"} dark:border-gray-700`,children:[e.jsx("td",{className:"p-3",children:s.id}),e.jsx("th",{className:"p-3 text-xs text-nowrap w-fit md:text-base",children:s.code}),e.jsx("th",{className:"p-3 text-xs text-nowrap w-fit md:text-base",children:s.name}),e.jsx("th",{className:"p-3 text-xs text-nowrap w-fit md:text-base",children:s.port_name}),e.jsxs("td",{className:"p-3 text-center text-nowrap",children:[t.user.permissions.includes("update-city")&&e.jsx("button",{onClick:()=>f(s),className:"mx-1 font-medium text-blue-600 dark:text-blue-500 hover:underline",children:"تعديل"}),t.user.permissions.includes("delete-city")&&e.jsx("button",{onClick:()=>O(s),className:"mx-1 font-medium text-red-600 dark:text-red-500 hover:underline",children:"حذف"})]})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"p-3 text-center",children:"لا يوجد مدن (Cities)"})})})]})}),d&&e.jsx(z,{links:d.meta.links})]})})})}),x&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"transition-all duration-300 ease-in-out transform scale-95 bg-white rounded-lg shadow-lg sm:w-1/2 dark:bg-gray-800 animate-in",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h2",{className:"text-lg font-semibold dark:text-white",children:"اضافة مدينة جديدة"})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:R,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(o,{className:"mb-1",htmlFor:"port_id ",value:"الميناء (الولاية)"}),e.jsx(I,{items:p.data,onItemSelect:s=>y("port_id",s.id),placeholder:"اختر الميناء",emptyMessage:"لا توجد موانئ"}),e.jsx(c,{message:v.port_id,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(o,{htmlFor:"city_name",value:"اسم المدينة "}),e.jsx(h,{id:"city_name",type:"text",name:"name",value:_.name,className:"block w-full mt-1",isFocused:!0,onChange:s=>y("name",s.target.value)}),e.jsx(c,{message:v.name,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(o,{htmlFor:"code",value:"كود المدينة "}),e.jsx(h,{id:"code",type:"text",name:"name",value:_.code,className:"block w-full mt-1",isFocused:!0,onChange:s=>y("code",s.target.value)}),e.jsx(c,{message:v.code,className:"mt-2"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:N,className:"px-4 py-2 text-white bg-gray-600 rounded hover:bg-gray-700",children:"إلغاء"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-white rounded bg-burntOrange ",children:"حفظ"})]})]})})]})}),n&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"transition-all duration-300 ease-in-out transform scale-95 bg-white rounded-lg shadow-lg sm:w-1/2 dark:bg-gray-800 animate-in",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h2",{className:"text-lg font-semibold dark:text-white",children:"تعديل المدينة"})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:U,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(o,{className:"mb-1",htmlFor:"edit_port_id",value:"الميناء (الولاية)"}),e.jsx(I,{items:p.data,selectedMakeId:w.port_id,onItemSelect:s=>b("port_id",s.id),placeholder:"اختر الميناء",emptyMessage:"لا توجد موانئ"}),e.jsx(c,{message:C.port_id,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(o,{htmlFor:"edit_city_name",value:"اسم المدينة"}),e.jsx(h,{id:"edit_city_name",type:"text",name:"name",value:w.name,className:"block w-full mt-1",isFocused:!0,onChange:s=>b("name",s.target.value)}),e.jsx(c,{message:C.name,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(o,{htmlFor:"edit_code",value:"اسم المدينة"}),e.jsx(h,{id:"edit_code",type:"text",name:"code",value:w.code,className:"block w-full mt-1",isFocused:!0,onChange:s=>b("code",s.target.value)}),e.jsx(c,{message:C.code,className:"mt-2"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>f(),className:"px-4 py-2 text-white bg-gray-600 rounded hover:bg-gray-700",children:"إلغاء"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-white rounded bg-burntOrange ",children:"حفظ التغييرات"})]})]})})]})})]})}function I({items:t,onItemSelect:d,placeholder:p,selectedMakeId:i,emptyMessage:r}){const[x,u]=m.useState(!1),[n,g]=m.useState(null);return m.useEffect(()=>{if(i){const a=t.find(j=>String(j.id)===String(i));g(a||null)}},[i,t]),e.jsxs(B,{open:x,onOpenChange:u,children:[e.jsx(K,{asChild:!0,children:e.jsxs(Z,{variant:"outline",role:"combobox","aria-expanded":x,className:"justify-between w-full",children:[n?n.name:p,e.jsx(L,{className:"w-4 h-4 ml-2 opacity-50 shrink-0"})]})}),e.jsx(G,{className:"w-full p-0",children:e.jsxs(V,{children:[e.jsx(W,{placeholder:""}),e.jsx(Y,{children:t&&t.length===0?e.jsx(H,{children:r}):e.jsx(J,{children:t&&t.map(a=>e.jsxs(Q,{value:a.name,onSelect:()=>{g(a),d(a),u(!1)},children:[e.jsx(X,{className:`mr-2 h-4 w-4 ${(n==null?void 0:n.id)===a.id?"opacity-100":"opacity-0"}`}),a.name]},a.id))})})]})})]})}export{me as default};
