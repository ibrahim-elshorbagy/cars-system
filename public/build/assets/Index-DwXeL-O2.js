import{r as h,W as D,j as e,Y as W,y as O}from"./app-BdDiG5MF.js";import{P as Y}from"./Pagination-D79vMfMK.js";import{T as l}from"./TextInput-BnM8wpwZ.js";import{A as G}from"./AuthenticatedLayout-CBw7v3pZ.js";import{I as s}from"./InputLabel-076v0EPL.js";import{I as t}from"./InputError-PGD3Jzm_.js";import{S as g}from"./SelectInput-B3moK6NF.js";import"./transition-Dkp8VegQ.js";import"./ThemeToggleButton-yQEJwIpi.js";function le({auth:u,site_settings:f,users:p,queryParams:r=null,success:H,roles:_,boxes:k,danger:J,whatsapp_redirect:N}){r=r||{},h.useEffect(()=>{N&&window.open(N,"_blank")},[N]);const[C,R]=h.useState(!1),[F,U]=h.useState(!1),[M,S]=h.useState(null),[A,E]=h.useState(""),[K,b]=h.useState(""),v=()=>{R(!C),E(""),I()},w=(a=null)=>{if(a){S(a);const i=Array.isArray(a.role_id)?a.role_id[0]:a.role_id;b(i),d({name:a.name,user_name:a.user_name,email:a.email,phone:a.phone,whatsapp:a.whatsapp,box_id:a.box_id,role:i,_method:"PUT"})}else S(null),b("");U(!F)},j=(a,i)=>{i?r[a]=i:delete r[a],delete r.page,O.get(route("user.index"),r)},y=(a,i)=>{i.key==="Enter"&&j(a,i.target.value)},T=a=>{window.confirm("هل انت متأكد من حذف المستخدم ؟ ")&&O.delete(route("user.destroy",a.id),{onSuccess:i=>{}})},{data:n,setData:m,post:B,errors:c,reset:I}=D({name:"",email:"",password:"",phone:"",whatsapp:""}),{data:o,setData:d,post:V,errors:x,reset:z}=D({name:"",email:"",password:"",phone:"",whatsapp:"",_method:"PUT"}),P=a=>{a.preventDefault(),B(route("user.store"),{onSuccess:()=>{I(),v()}})},L=a=>{a.preventDefault(),V(route("user.update",M.id),{onSuccess:()=>{z(),w()}})};return e.jsxs(G,{user:u.user,site_settings:f,header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight dark:text-gray-200",children:"المستخدمين"}),u.user.permissions.includes("create-user")&&e.jsx("button",{onClick:v,className:"px-3 py-1 text-white transition-all rounded shadow bg-burntOrange ",children:"إضافة مستخدم"})]}),children:[e.jsx(W,{title:f.websiteName+" - المستخدمين"}),e.jsx("div",{className:"",children:e.jsx("div",{className:"mx-auto ",children:e.jsx("div",{className:"overflow-hidden overflow-y-auto bg-white shadow-sm dark:bg-gray-800 ",children:e.jsxs("div",{className:"p-3 text-gray-900 md:p-6 dark:text-gray-100",children:[e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-gray-500 rtl:text-right dark:text-gray-400",children:[e.jsx("thead",{className:"text-gray-700 uppercase border-b-2 border-gray-500 bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{className:"text-nowrap",children:[e.jsx("td",{children:"Id"}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base min-w-36",children:"اسم المستخدم"}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base min-w-36",children:"الاسم"}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base min-w-36",children:"البريد الإلكتروني"}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base min-w-36",children:"الهاتف"}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base min-w-36",children:"whatsapp"}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base min-w-36",children:"الدور"}),e.jsx("td",{className:"p-3 text-xs text-nowrap md:text-base min-w-36",children:"تاريخ الإنشاء"}),e.jsx("th",{className:"p-3 text-xs text-nowrap md:text-base min-w-36",children:"الإجراءات"})]})}),e.jsx("thead",{className:"text-xs text-gray-700 uppercase border-b-2 border-gray-500 bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{className:"text-nowrap",children:[e.jsx("th",{className:"p-3"}),e.jsx("th",{className:"p-3",children:e.jsx(l,{className:"w-full",defaultValue:r.user_name,placeholder:"اسم المستخدم",onBlur:a=>j("user_name",a.target.value),onKeyPress:a=>y("user_name",a)})}),e.jsx("th",{className:"p-3",children:e.jsx(l,{className:"w-full",defaultValue:r.name,placeholder:"الاسم",onBlur:a=>j("name",a.target.value),onKeyPress:a=>y("name",a)})}),e.jsx("th",{className:"p-3",children:e.jsx(l,{className:"w-full",defaultValue:r.email,placeholder:"البريد الإلكتروني",onBlur:a=>j("email",a.target.value),onKeyPress:a=>y("email",a)})}),e.jsx("th",{className:"p-3"}),e.jsx("th",{className:"p-3"}),e.jsx("th",{className:"p-3"}),e.jsx("th",{className:"p-3"}),e.jsx("th",{className:"p-3"})]})}),e.jsx("tbody",{children:p&&p.data.length>0?p.data.map(a=>e.jsxs("tr",{className:"bg-white border-b dark:bg-gray-800 dark:border-gray-700",children:[e.jsx("td",{className:"px-3 py-2",children:a.id}),e.jsx("th",{className:"px-3 py-2 text-nowrap",children:a.user_name}),e.jsx("th",{className:"px-3 py-2 text-nowrap",children:a.name}),e.jsx("td",{className:"px-3 py-2",children:a.email}),e.jsx("td",{className:"px-3 py-2",children:a.phone}),e.jsx("td",{className:"px-3 py-2",children:a.whatsapp}),e.jsx("td",{className:"px-3 py-2",children:a.role}),e.jsx("td",{className:"px-3 py-2 text-nowrap",children:a.created_at}),e.jsxs("td",{className:"px-3 py-2 text-nowrap",children:[u.user.permissions.includes("update-user")&&a.id!=1&&e.jsx("button",{onClick:()=>w(a),className:"mx-1 font-medium text-blue-600 dark:text-blue-500 hover:underline",children:"تعديل"}),u.user.permissions.includes("delete-user")&&a.id!=1&&e.jsx("button",{onClick:()=>T(a),className:"mx-1 font-medium text-red-600 dark:text-red-500 hover:underline",children:"حذف"})]})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-3 py-2 text-center",children:"لا يوجد مستخدمين"})})})]})}),p&&e.jsx(Y,{links:p.meta.links})]})})})}),C&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"transition-all duration-300 ease-in-out transform scale-95 bg-white rounded-lg shadow-lg sm:w-1/2 dark:bg-gray-800 animate-in",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h2",{className:"text-lg font-semibold dark:text-white",children:"إضافة مستخدم جديد"})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:P,children:[e.jsxs("div",{children:[e.jsx("div",{className:"mb-4 text-lg text-gray-700 dark:text-white",children:"معلومات الدخول"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"user_name",value:"اسم المستخدم"}),e.jsx(l,{id:"user_name",type:"text",name:"name",value:n.user_name,className:"block w-full mt-1",isFocused:!0,onChange:a=>m("user_name",a.target.value)}),e.jsx(t,{message:c.user_name,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"user_email",value:"البريد الإلكتروني"}),e.jsx(l,{id:"user_email",type:"email",name:"email",value:n.email,className:"block w-full mt-1",onChange:a=>m("email",a.target.value)})]}),e.jsx(t,{message:c.email,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"user_password",value:"كلمة المرور"}),e.jsx(l,{id:"user_password",type:"password",name:"password",value:n.password,className:"block w-full mt-1",onChange:a=>m("password",a.target.value)}),e.jsx(t,{message:c.password,className:"mt-2"})]})]}),e.jsx("div",{className:"mb-4 text-lg text-gray-700 dark:text-white",children:"معلومات اضافيه"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"name",value:"الاسم الكامل"}),e.jsx(l,{id:"name",type:"text",name:"name",value:n.name,className:"block w-full mt-1",onChange:a=>m("name",a.target.value)}),e.jsx(t,{message:c.name,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"role",value:"الصلاحيات"}),e.jsxs(g,{name:"role",id:"role",className:"block w-full mt-1",value:n.role,onChange:a=>{m("role",a.target.value),E(a.target.value)},children:[e.jsx("option",{value:"",children:"اختر"}),_.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsx(t,{message:c.role,className:"mt-2"})]})]}),A==4&&e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"box_id",value:"اختر الصندوق"}),e.jsxs(g,{name:"box_id",id:"box_id",className:"block w-full mt-1",value:n.box_id,onChange:a=>m("box_id",a.target.value),children:[e.jsx("option",{value:"",children:"اختر الصندوق"}),k.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsx(t,{message:c.box_id,className:"mt-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"phone",value:"الهاتف"}),e.jsx(l,{id:"phone",type:"text",name:"phone",dir:"ltr",value:n.phone,placeholder:"+962799504930",className:"block w-full mt-1",onChange:a=>m("phone",a.target.value)}),e.jsx(t,{message:c.phone,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"whatsapp",value:"whatsapp"}),e.jsx(l,{id:"whatsapp",type:"text",name:"whatsapp",dir:"ltr",value:n.whatsapp,placeholder:"+962799504930",className:"block w-full mt-1",onChange:a=>m("whatsapp",a.target.value)}),e.jsx(t,{message:c.whatsapp,className:"mt-2"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:v,className:"px-4 py-2 text-white bg-gray-600 rounded hover:bg-gray-700",children:"إلغاء"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-white rounded bg-burntOrange ",children:"حفظ"})]})]})})]})}),F&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"transition-all duration-300 ease-in-out transform scale-95 bg-white rounded-lg shadow-lg sm:w-1/2 dark:bg-gray-800 animate-in",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h2",{className:"text-lg font-semibold dark:text-white",children:"تعديل المستخدم"})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:L,children:[e.jsx("div",{className:"mb-4 text-lg text-gray-700 dark:text-white",children:"معلومات الدخول"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"edit_user_name",value:"اسم المستخدم"}),e.jsx(l,{id:"edit_user_name",type:"text",name:"name",value:o.user_name,className:"block w-full mt-1",onChange:a=>d("user_name",a.target.value)}),e.jsx(t,{message:x.user_name,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"edit_user_email",value:"البريد الإلكتروني"}),e.jsx(l,{id:"edit_user_email",type:"email",name:"email",value:o.email,className:"block w-full mt-1",onChange:a=>d("email",a.target.value)}),e.jsx(t,{message:x.email,className:"mt-2"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"edit_user_password",value:"كلمة المرور"}),e.jsx(l,{id:"edit_user_password",type:"password",name:"password",value:o.password,className:"block w-full mt-1",placeholder:"اكتب في حالة اردت تغيرها",onChange:a=>d("password",a.target.value)}),e.jsx(t,{message:x.password,className:"mt-2"})]}),e.jsx("div",{className:"mb-4 text-lg text-gray-700 dark:text-white",children:"معلومات اضافيه"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"edit_user_name",value:"الاسم الكامل"}),e.jsx(l,{id:"edit_user_name",type:"text",name:"name",value:o.name,className:"block w-full mt-1",onChange:a=>d("name",a.target.value)}),e.jsx(t,{message:x.name,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"edit_user_role",value:"الصلاحيات"}),e.jsxs(g,{name:"role",id:"edit_user_role",className:"block w-full mt-1",value:o.role,onChange:a=>{d("role",a.target.value),b(a.target.value)},children:[e.jsx("option",{value:"",children:"اختر"}),_.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsx(t,{message:x.role,className:"mt-2"})]})]}),K==4&&e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"edit_box_id",value:"اختر الصندوق"}),e.jsxs(g,{name:"box_id",id:"edit_box_id",className:"block w-full mt-1",value:o.box_id,onChange:a=>d("box_id",a.target.value),children:[e.jsx("option",{value:"",children:"اختر الصندوق"}),k.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsx(t,{message:x.box_id,className:"mt-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"edit_phone",value:"الهاتف"}),e.jsx(l,{id:"edit_phone",type:"text",name:"phone",dir:"ltr",value:o.phone,placeholder:"+962799504930",className:"block w-full mt-1",onChange:a=>d("phone",a.target.value)}),e.jsx(t,{message:x.phone,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(s,{htmlFor:"edit_whatsapp",value:"whatsapp"}),e.jsx(l,{id:"edit_whatsapp",type:"text",name:"whatsapp",dir:"ltr",value:o.whatsapp,placeholder:"+962799504930",className:"block w-full mt-1",onChange:a=>d("whatsapp",a.target.value)}),e.jsx(t,{message:x.whatsapp,className:"mt-2"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>w(),className:"px-4 py-2 text-white bg-gray-600 rounded hover:bg-gray-700",children:"إلغاء"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-white rounded bg-burntOrange ",children:"حفظ التغييرات"})]})]})})]})})]})}export{le as default};
